<!doctype html>

<body>
    <canvas id="gameCanvas" width="600" height="600">
    </canvas>
    <script>
        var canvas, canvasContext;

        window.onload = function() {
            canvas = document.getElementById('gameCanvas');
            canvasContext = canvas.getContext('2d');

            document.addEventListener('keydown', keyPressed);
            document.addEventListener('keyup', keyReleased);
            
            for(var i = 0; i < totalEnemies; i++){
                makeEnemies();
            }
         

            setInterval(mainloop, 1000 / 50);

        }
        
        //bullet
        var bulletXpos = 601;
        var bulletYpos = 601;
        const BULLET_WIDTH = 4;
        const BULLET_HIGHT = 6;
        var bulletYspeed = 10;

        var playerXpos = 290;
        var playerYpos = 500;
        const PlAYER_SIZE = 50;
        var playerXspeed = 5;
        var playerYspeed = 5;
        
        var score = 0;
        
        var enemyXpos = 1;
        var enemyYpos = 1;
        const ENEMY_SIZE = 20;
        var enemyXspeed= 5;
        var enemyYspeed= 5;
        

        const LEFT_KEY = 65;
        const RIGHT_KEY = 68;
        
        const SPACE_KEY = 32;

        var leftkeyPressed = false;
        var rightkeyPressed = false;
        
        var startingPos = true;
        
        var totalEnemies = 10;
        var enemies = []; 
        
        var gameRun = true;
        
        var ship = new Image();
        ship.src = 'images/ship.png';

        
        function mainloop() { //mainloop were you want stuff on screen.
            colorRect(0,0,canvas.width,canvas.height,'black');
            
//            colorRect(playerXpos, playerYpos, PlAYER_SIZE, PlAYER_SIZE, 'red');//the charcter youll be playing in the game
            colorRect(bulletXpos, bulletYpos, BULLET_WIDTH, BULLET_HIGHT, 'white');// bullet
            
            if (startingPos) {
                startPos();
                console.log('here')
                startingPos = false;
            }
            
            playerMove();
            bulletshoot();
            
            enemiesDraw();
            enemiesMove();
            imageDrawing(ship,playerXpos,playerYpos,PlAYER_SIZE,PlAYER_SIZE);
            
        } // end func

        function keyPressed(evt) {

            if (evt.keyCode == LEFT_KEY) {
                leftkeyPressed = true;
            }
            if (evt.keyCode == RIGHT_KEY) {
                rightkeyPressed = true;
            }
            if (evt.keyCode == SPACE_KEY){
                shooting = true;
            }
        } //end func

        function keyReleased(evt) {
            if (evt.keyCode == LEFT_KEY) {
                leftkeyPressed = false;
            }
            if (evt.keyCode == RIGHT_KEY) {
                rightkeyPressed = false;
            }
        } //end func
        
            

        function playerMove() {//player 
            if (rightkeyPressed) { // rightkeypressed 
                playerXpos += playerXspeed;
            }
            if (leftkeyPressed) { // leftkeyPressed 
                playerXpos -= playerXspeed;
            }

        } // end func
        
        var max = 10;
        var min = 2;
        
        function makeEnemies(){
            const E_SIZE = 20;
            var eXpos = Math.floor(Math.random()*(canvas.width - E_SIZE));
            var eYpos = 0;
            var eYspeed = Math.floor(Math.random()*(max - min)) + min;
            
            var enemy = {
                eXpos: eXpos,
                eYpos: eYpos,
                E_SIZE: E_SIZE,
                eYspeed: eYspeed
            }
            
            enemies.push(enemy);
        }
        
        function enemiesDraw(){
            enemies.forEach(function(e,i,array){
                colorRect(e.eXpos,e.eYpos,e.E_SIZE,e.E_SIZE,'gray');
            });
        }
        
        function enemiesMove(){
             enemies.forEach(function(e,i,array){
                e.eYpos += e.eYspeed;
            });
        }
        
        var shooting = false;
        var shot = false;
        
        function bulletshoot(){
            if(shooting && shot == false){
               bulletXpos = playerXpos + PlAYER_SIZE / 2 - BULLET_WIDTH / 2; // x center
               bulletYpos = playerYpos;
               shot = true //bullet size and function
                
               }
            if (shooting && shot){
                 bulletYpos -= bulletYspeed
                
                }
            if (bulletYpos < 0 || bulletXpos + BULLET_WIDTH > enemyXpos && bulletXpos < enemyXpos + ENEMY_SIZE && bulletYpos + BULLET_HIGHT > enemyYpos && bulletYpos < enemyYpos + ENEMY_SIZE){
                 shot = false;
                 shooting =false
            }
            if(shot == false && shooting == false){
                 bulletXpos = 0;
                 bulletYpos = 0;
               }
        } // end func

        function startPos() {
            playerXpos = canvas.width / 2 - PlAYER_SIZE / 2;
            playerYpos = canvas.height * 0.8;
        }

        function colorRect(x, y, w, h, c) {
            canvasContext.fillStyle = c;
            canvasContext.fillRect(x, y, w, h);
        }
        
        function imageDrawing(src,x,y,w,h){
            	canvasContext.drawImage(src,x,y,w,h);

        }
        
        function colorText(msg,x,y,f,c){
            canvasContext.fillStyle = c;
            canvasContext.font = f;
            canvasContext.fillText(msg,x,y);
        }
        
        

    </script>
</body>
